language: ruby
rvm:
  - 2.1.5

services:
  - postgres

before_script:
  - ./shippable.sh
  - psql -c 'create database "commiker_test";' -U postgres
  - rake db:migrate

after_failure:
  - python slack_notifier.py --project ${REPO_NAME} --org ${SLACK_ORG} --token ${SLACK_TOKEN}
after_success:
  - python slack_notifier.py --project ${REPO_NAME} --org ${SLACK_ORG} --token ${SLACK_TOKEN} -s

script:
  - rspec
